# 第四章 用例建模
## 用例建模定义
### 是什么？
> 在产品的开发过程中，需求的管理尤为重要。用例建模就是高效管理需求的工具之一。
> 随着项目的开展，我们可以通过一系列的需求活动管理去挖掘出系统的相关信息，并通过 **分析问题来理解干系人的需求**。
> > 在定义系统的过程中，我们可以利用简略的 **用例规约**，对 **系统的功能** 和 **业务过程** 进行表示。在融入领域相关信息后，对系统进行详细化完善，最终形成更加详细的 **用例规约描述**。我们正是在这个过程中逐步形成 **用例模型**的，进而我们可以管理 ***变化的需求***。该过程的流程简化如下：
1. **分析需求活动中的管理问题**
2. 在此基础上**理解干系人的需求**
3. 根据对需求管理的理解，**形成对系统的定义**
4. 初步得到 **用例规约(简略版)**
5. **融入相关的领域知识**
6. 在此基础上，**进一步完善系统**
7. 得到**用例规约(详细版)**
### 为什么用？
> 利用用例模型，可以很好地 **描述系统的功能性需求**。
> > 在UML中，**一个用例模型通常由若干个用例图组成**，用来**表示系统实现的业务过程**，并**表述系统的工作方式**。我们可以通过用例模型来理解和表示系统所能提供的服务。显然，使用用例模型有利于实现对需求的验证和确认和辅助规划开发的过程，并有利于宏观地了解系统。
<img src="../软件工程笔记/第四章图片/原因.png">

**用例模型的两种描述：文本表述与用例图描述**
**用例建模的过程中 ，重要的是对用例进行描述，画图只是其中的一小部分工作。**
1. >**文本描述**：给出参与者和用例的具体信息。
   >> 文本描述包含了用例模型的摘要（简要介绍了系统的功能和意义，以及相关的参与者和用例），和用例规约的描述（每个用例规约详细描述用例中会发生的可能性操作和事件，以及涉及的非功能需求和规则约束等，即对用例的每个事件流进行描述）
<img src="../软件工程笔记/第四章图片/文本描述.png">

2. >**用例图描述**：用来显示一组用例、参与者以及它们间的关系。体现在一个功能性系统上就是：1、系统涉及哪方面的业务；2、系统会和那些系统与对象进行交互；3、不同的对象、系统如何与该系统进行交互。
以ATM机用例图为例：
<img src="../软件工程笔记/第四章图片/ATM.png">

**用例图的主要元素**
<img src="../软件工程笔记/第四章图片/用例元素.png">

* 参与者（actor）：与系统交互的 **人** 或 **外部系统**，注意，前提是会与系统进行交互。
>参与者不等同于用户（实例），应该注重于用户所承担的 **角色**，命名时应体现出角色的特性。参与者是基于角色而划分的。
<img src="../软件工程笔记/第四章图片/参与者.png">

* 用例(use case)：系统为参与者提供的有价值的服务功能，是一个细化的系统行为需求。（用例名应为 动宾结构  v+n，系统是该用例服务的提供商）用来描述系统应该做什么，而不是如何做。
> 一个用例定义了**系统的一系列行为**，通过用例可以为参与者提供**有价值**且**可观测**的结果。该用例功能涵盖了一系列的原子操作，代表参与者和系统间的交互过程，这些操作是原子性的，要么都执行，要么都不执行。
> >用例往往用来和用户确定需求，辅助开发团队规划开发进度，故**使得用例被定义的对象一定是该系统的最终服务对象，不必为开发人员等定义用例。** 用例必须有可观测的结果，这样才能观察到系统是否达到了用户的预期目标。参与者与系统的每一种不同的交互方式都是一个用例。
>>> 用例的定义往往还需要以来参与者的信息。
<img src="../软件工程笔记/第四章图片/用例.png">

* 关联（association）：在用例图中表示 参与者 与 用例 间的交互关系。
>我们通常将获取用例多提供价值的参与者定义为**主参与者**，主参与者是服务的主要受益方，但不一定是主动发起交互的一方。
>>箭头表示的信息约束性较强，建议仅当有明确需求说明时，按照箭头的使用规范进行表示。
>>> 1. 如果图中标明了箭头相应的信息，应该在用例文本描述中有所体现，标识在何种情况下进入用例。2. 箭头表示不是必须的，仅当需求中有明确的定义时才进行使用。3. 如果有两个及以上的箭头指向同一个用例的情况时属于异常的表示，在大部分情况下，应该是一个指向用例的箭头，其他的箭头应该由用例指出或无方向。4. 箭头的指向只表示消息的传递方向，并不表示哪个参与者创建用例，或用例服务的受益方。
<img src="../软件工程笔记/第四章图片/关联.png">

**注意可从用例图中提取到的信息**：
1. 用例的优先级，分清用例的主次关系（有利于开发时进行进度规划）（判断方法：1、主观判断；2、根据用例服务对象判断，为主要对象提供的服务一定为优先级高的用例，次等级用例一般不直接服务于主要参与者）
2. 穷举所有用例可以得到完整的需求描述。

**每一个交互-关联：表示着参与者与系统间的一个完整的对话**

**场景(scenario)是用例的实例**
系统会根据我们不同的信息进入不同的（交互）场景，所以我们认为场景为用例的一个实例。
一个用例拥有不同的场景，这说明其会有不同的事件流。**我们在用例文档描述时，需要将不同的场景分别进行描述。**
场景可以表达正面的行为需求，也可以表达反面的、不希望发生的交互（如，因为去请求不合理而驳回请求）。**场景还可以包括并行机制，在每个选择点进行一种情况的具体描述。**
**场景**的重要辩体表明了会对企业等产生严重影响的事件流。

## 用例建模过程（共两步）
### 第一步
**找到参与者和用例**。利用客户的需求和潜在使用者信息来寻找参与者和用例。
**1、寻找潜在使用者角色的方法**：
* 思考系统的设计目的是为了那些人或物，将不同的用户类型表示为不同的参与者。
* 思考那些人或物从系统中获取信息。
* 思考那些人或物向系统中提供信息。
* 公司的哪个部门会使用系统。
* 谁/什么应该负责系统的维护。
* 思考那些系统会使用该系统。
**2、识别谁是参与者**
方法：思考谁与系统进行交互。
**3、在用例文档描述中对参与者信息进行细化**
1. 参与者的名称要明确指明参与者与系统交互时的身份，且参与者的命名应该唯一来与其他参与者进行区分，将参与者命名为用户（人）名是不恰当的，这无法表示用户的身份。
2. 对参与者进行简要描述。包括该参与者代表了那些（类）用户；为什么需要该参与者；参与者对系统的具体需求。
3. 参与者和用例间的关系。调度器（时钟）属于特殊的参与者，适用于在一些系统中，案例只在一定时间被触发的情况。
**4、对参与者建模的检查（项）**
<img src="../软件工程笔记/第四章图片/对参与者检查.png">

**5、寻找用例**
在寻找参与者时要描述系统为参与者提供的服务，以及参与者如何与系统进行交行。这就是寻找用例的过程。
在寻找用例时，最好的方法是将自己当做参与者与系统进行交互，同时不要一开始就尝试去捕捉所有的细节，我们要去全面的认识和定义所有的用例，以穷举的方式取考虑每个参与者与系统的交互情况。
**寻找用例的方法：**
<img src="../软件工程笔记/第四章图片/寻找用例方法.png">

不要忘记系统的启动、中止和维护等用例和调度器根据时间触发的用例等。设计过程中避免用例力度过粗和过细的情况。
**寻找用例和参与者的过程是不能完全分开的。**
**6、对用例进行文本描述**
**用例的名称**（动宾结构）唯一，且能清楚表达了参与者与系统交互的目标或其起到的作用。
**用例的简要描述**中包括介绍参与者与用户如何交互、系统需进行那些原子操作等。在敏捷开发过程中，每一次迭代可以选择部分用例进行细化描述，通过这样的方式，设置用例的优先级来保证其中重要的功能尽快完成交付。
**建立参与者与用例间的关联关系**。直线或方向箭头表示。
**7、对用例建模的检查（项）**
<img src="../软件工程笔记/第四章图片/对用例检查.png">

CRUD用例可以概括为 维护顾客信息 用例。

### 第二步
**编写用例，补充用例的事件流。**为每一个用例进行具体的文档描述，包括给用例事件流程划分重要等级；按照重要程度排序，描述事件流程。
> **用例提纲(outline)**涵盖了大致的事件流程。通过用力提纲可以大致了解用例的规模和复杂程度。
该用例描述就是在第一步中简要描述的基础上，对用例描述进行扩展，形成用例提纲（加上 粗略的事件流程）。之后对用例提纲进行细化，并增加条件说明等，形成更加详细的规约（加上 详细的事件流程）。
> 用例建模的过程是逐步扩充的，迭代细化的。
**用例建模步骤**：
1. 通过分析需求识别到用例（如 下订单）
2. 进行用例概述(briefly described)，包括用例的目的，需要涵盖事件流的主要部分。
3. 从简要描述中抽离基础事件流，形成用例提纲
4. 通过将事件流中的选择条件、约束等进一步细化，并增加前置、后置条件，完成用例详细规约（fully described）的描述。该细化过程往往是配合开发过程迭代进行的，所以需要考虑需求的优先程度。
用例概述中，我们将主体事件流抽离，且需要兼顾不同的场景，设计系统时也要对特殊情景（候选场景）进行考虑。
用例规约中，要包含用例名称、用例进行的前置条件、用例的事件流描述、异常情况、用例进行的后置条件。
**细化用例规约例子**
<img src="../软件工程笔记/第四章图片/用例举例.png">

**用例文档模板（包含用例规约的全部内容）：**
<img src="../软件工程笔记/第四章图片/模板.png">

**用例模型建模步骤总结：**
<img src="../软件工程笔记/第四章图片/步骤总结.png">

## 用例建模要点
1. **明确系统的边界**是用例建模的一个重要环节。
> **系统的边界**：一个系统所包含的所有系统成分（含用例）和系统以外各种事物（含参与者）的分界线。
> >系统边界的选择会对 参与者 与 用例 的定义产生影响。会影响到与系统交互的对象和参与者与系统的交互方式。
2. 确定系统边界后，进行功能分解，注意用例定义与功能分解不等同。
> **功能分解**：将问题分解为粒度小，且独立的部分。不同部分组合后能形成原始问题的一个完整解决方案。
>> 分解会使得部分丧失上下文语境，分解的越详细，每个部分九月细小，就需要更多的接口来连接这些部分。但这样的定义方式存在隐患。在需求的定义中都非常需要上下文语境消息，所以用例并不是功能分解的过程。
>>>我们用用例描述需求，在很大程度上与功能分解的效果相一致，但干系人的需求是在一定语义时才有意义。用例是综合了所以功能，一起来描述系统是如何使用的，其包含丰富的语境信息。
<img src="../软件工程笔记/第四章图片/功能分解.png">

通过功能划分得到的细小用例往往没有实际的价值，即使是从名字上理解，我们也很难从中理解整体的模型。所以应避免功能性分解，为此我们应该时刻思考正确的用例定义。
<img src="../软件工程笔记/第四章图片/避免功能分解.png">

3. 在定义复杂的系统时，我们需要考虑用例与用例间的关系，这包括包含关系、拓展关系。
4. <img src="../软件工程笔记/第四章图片/包含关系的使用.png">
5. <img src="../软件工程笔记/第四章图片/扩展关系的使用.png">

**用例图中的图标**
<img src="../软件工程笔记/第四章图片/用例图的图标.png">

## 部分建模工具
>系统建模的工具的最主要功能在于 **可视化模型的表达**。
>建模工具通过可视效果辅助用户表达和理解模型，其核心之一在于画图。同时很多建模工具往往融合了辅助开发流程中项目管理的功能，可辅助进行需求跟踪、团队管理等复杂功能。
<img src="../软件工程笔记/第四章图片/可视化模型表达.png">
<img src="../软件工程笔记/第四章图片/建模工具.png">

在众多的系统建模工具中，有许多都是基于 **UML模型**设计开发的。使用UML统一建模语言好处众多，实现以一致的方式构建强健的和可跟踪的软件系统模型。
